import{v as z,x as B,r as _,q as w,s as T,d as e,u as n,t as o,B as m,aa as v,Q as p,A as V,z as F,ab as L}from"./index.16fafb50.js";import{a as C,Q as q}from"./QCard.9550f461.js";import{Q as I}from"./QPage.bd9db12d.js";import{Q as S,a as U,b as s,c as K,d as $}from"./QTooltip.c51851d1.js";import{Q as N}from"./QBtnGroup.8a143a29.js";import{u as M}from"./useObtenerPeriodos.fd2c7100.js";import{u as D,a as G}from"./useForzarEliminaci\xF3nRecurso.225e6ff9.js";import{u as j}from"./useQueryClient.esm.ad4fb503.js";import{_ as R}from"./DialogEliminar.48da2dec.js";import{_ as O}from"./BreadcrumbNav.24a9f6cf.js";import{g as H}from"./getUser.66bacbda.js";import{u as J}from"./useRecursosEliminados.dcfd38af.js";import{u as W}from"./useRestaurarRecurso.c88508a3.js";import"./use-dark.fd3c0586.js";import"./QSeparator.c2a03803.js";import"./QList.747496ef.js";import"./QMarkupTable.c292dae4.js";import"./QSelect.3768a279.js";import"./use-key-composition.749118dd.js";import"./uid.42677368.js";import"./focus-manager.05708ea9.js";import"./QChip.fc1367d4.js";import"./QItem.98cb2d4c.js";import"./QItemLabel.bb4f8a3f.js";import"./QMenu.ab6378a2.js";import"./selection.fb3d903a.js";import"./focusout.5c99f0fb.js";import"./QDialog.82b87909.js";import"./use-prevent-scroll.175dc396.js";import"./use-form.e491c393.js";import"./format.2bc25e5f.js";import"./use-checkbox.abf6af25.js";import"./use-fullscreen.eb530c2b.js";import"./useRecursosMultiples.fa0015da.js";import"./documentosApi.d4af84c5.js";import"./axios.a596eead.js";import"./useQuery.esm.48506497.js";import"./utils.esm.429db25b.js";import"./useMutation.esm.3aac1ad5.js";import"./mutation.esm.54ea4acf.js";import"./QCardActions.4c1c4976.js";import"./ClosePopup.159f4ab9.js";const X=()=>(j().invalidateQueries({queryKey:["periodo-activo"],exact:!1}),D("/periodos","Se elimin\xF3 el periodo")),A=[{field:"nombre",name:"nombre",label:"Nombre del periodo",align:"left",sortable:!0},{field:"fecha_inicio",name:"fecha_inicio",label:"Fecha de inicio.",align:"left",sortable:!0},{field:"fecha_termino",name:"fecha_termino",label:"Fecha de termino",align:"left",sortable:!0},{field:"accion",name:"accion",label:"Acci\xF3n",align:"right"}],Y=z({__name:"TablaPeriodo",setup(g){const a=B(),l=_(!1),d=_(""),{data:f,isLoading:y}=M(),{eliminarRecurso:h}=X(),b=u=>{a.push({name:"ver-periodo",params:{id:u}})},k=u=>{a.push({name:"editar-periodo",params:{id:u}})},E=u=>{l.value=!0,d.value=u};return(u,P)=>(w(),T("div",null,[e(R,{modelValue:l.value,"onUpdate:modelValue":P[0]||(P[0]=r=>l.value=r),"recurso-id":d.value,onEliminar:n(h)},null,8,["modelValue","recurso-id","onEliminar"]),e(S,{flat:"",bordered:"",rows:n(f),columns:n(A),"row-key":"nombre",loading:n(y),pagination:{rowsPerPage:15}},{body:o(r=>[e(U,{props:r},{default:o(()=>[e(s,{key:"nombre",props:r},{default:o(()=>[m(v(r.row.nombre),1)]),_:2},1032,["props"]),e(s,{key:"fecha_inicio",props:r},{default:o(()=>[m(v(r.row.fecha_inicio),1)]),_:2},1032,["props"]),e(s,{key:"fecha_termino",props:r},{default:o(()=>[m(v(r.row.fecha_termino),1)]),_:2},1032,["props"]),e(s,{key:"accion",props:r},{default:o(()=>[e(N,{push:""},{default:o(()=>[e(p,{size:"sm",color:"info",push:"",glossy:"",icon:"visibility",onClick:x=>b(r.row.id)},null,8,["onClick"]),e(p,{size:"sm",color:"secondary",push:"",glossy:"",icon:"edit",onClick:x=>k(r.row.id)},null,8,["onClick"]),e(p,{size:"sm",color:"negative",push:"",glossy:"",icon:"delete",onClick:x=>E(r.row.id)},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading"])]))}}),Z=()=>(j().invalidateQueries({queryKey:["periodo-activo"],exact:!1}),J("periodos-trashed",["periodos-trashed"],{},{staleTime:1e3*60*60})),ee=()=>G("periodos-force-delete","periodos-trashed"),oe=()=>W("/periodos-restore","periodos","periodos-trashed"),ie={class:"flex justify-end q-gutter-md q-mb-md"},re=z({__name:"TablaPeriodoEliminado",setup(g){const a=_([]),l=_(!1),d=_(!1),f=_(""),{data:y,isLoading:h}=Z(),{eliminarRecurso:b}=ee(),{restaurarRecurso:k}=oe(),E=c=>{b(c)},u=()=>{l.value=!0},P=c=>{d.value=!0,f.value=c},r=()=>{const c=a.value.map(t=>t.id.toString());k(c),a.value=[]},x=()=>{const c=a.value.map(t=>t.id.toString());b(c),a.value=[]};return(c,t)=>(w(),T("div",null,[e(R,{modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=i=>d.value=i),"recurso-id":f.value,icon:"delete_forever",onEliminar:E,mensaje:"\xBFEstas seguro de eliminar este periodo? Si se llega a eliminar, todos los datos se perder\xE1n para simpre y por simpre. \xA1Piensalo!"},null,8,["modelValue","recurso-id"]),e(R,{modelValue:l.value,"onUpdate:modelValue":t[1]||(t[1]=i=>l.value=i),"recurso-id":a.value,icon:"delete_forever",onEliminar:x,mensaje:"\xBFEstas seguro de eliminar estos periodos? Si se llega a eliminar, todos los datos se perder\xE1n para simpre y por simpre. \xA1Pi\xE9nsalo!"},null,8,["modelValue","recurso-id"]),V("div",ie,[e(p,{disable:!a.value.length,color:"secondary",icon:"restore",onClick:r},null,8,["disable"]),e(p,{disable:!a.value.length,color:"negative",icon:"delete_forever",onClick:u},null,8,["disable"])]),e(S,{flat:"",bordered:"",rows:n(y),columns:n(A),"row-key":"id",loading:n(h),pagination:{rowsPerPage:15},selection:"multiple",selected:a.value,"onUpdate:selected":t[2]||(t[2]=i=>a.value=i)},{body:o(i=>[e(U,{props:i},{default:o(()=>[e(s,null,{default:o(()=>[e(K,{modelValue:i.selected,"onUpdate:modelValue":Q=>i.selected=Q},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(s,{key:"nombre",props:i},{default:o(()=>[m(v(i.row.nombre),1)]),_:2},1032,["props"]),e(s,{key:"fecha_inicio",props:i},{default:o(()=>[m(v(i.row.fecha_inicio),1)]),_:2},1032,["props"]),e(s,{key:"fecha_termino",props:i},{default:o(()=>[m(v(i.row.fecha_termino),1)]),_:2},1032,["props"]),e(s,{key:"accion",props:i},{default:o(()=>[e(N,{push:""},{default:o(()=>[e(p,{size:"sm",color:"secondary",push:"",glossy:"",icon:"restore",onClick:Q=>n(k)(i.row.id)},{default:o(()=>[e($,null,{default:o(()=>[m(" Restaurar periodo ")]),_:1})]),_:2},1032,["onClick"]),e(p,{size:"sm",color:"negative",push:"",glossy:"",icon:"delete_forever",onClick:Q=>P(i.row.id)},{default:o(()=>[e($,null,{default:o(()=>[m(" Forzar eliminaci\xF3n ")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading","selected"])]))}}),ae={class:"flex justify-between items-center"},te=V("div",{class:"fontsize-15 text-weight-light"},"Periodos",-1),le=V("div",{class:"fontsize-15 text-weight-light"},"Peridos eliminadas",-1),Je=z({__name:"ListarPeriodo",setup(g){const a=B(),l=()=>{a.push({name:"crear-periodo"})},d=H(),f=[{label:"Periodos",icon:"date_range"}];return(y,h)=>(w(),F(I,{padding:""},{default:o(()=>[e(O,{pages:f,titlePage:"Lista de periodos"}),e(q,null,{default:o(()=>[e(C,null,{default:o(()=>[V("div",ae,[te,e(p,{label:"Nuevo",icon:"add_circle_outline",color:"secondary",size:"md",padding:"xs",onClick:l})])]),_:1}),e(C,null,{default:o(()=>[e(Y)]),_:1})]),_:1}),n(d)==="admin"?(w(),F(q,{key:0,class:"q-mt-md"},{default:o(()=>[e(C,null,{default:o(()=>[le]),_:1}),e(C,null,{default:o(()=>[e(re)]),_:1})]),_:1})):L("",!0)]),_:1}))}});export{Je as default};
