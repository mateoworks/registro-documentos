import{aU as w,aV as k,v as S,x as E,r as $,q as a,s as u,u as i,z as h,ab as x,d as t,A as e,Q as _,t as n,F as T,ar as A,ap as V,B as y,aa as d,aR as F,_ as N,C as U,D as j}from"./index.16fafb50.js";import{a as z,Q as D}from"./QCard.9550f461.js";import{Q as K}from"./QPage.bd9db12d.js";import{Q as M}from"./QImg.f997db3b.js";import{Q as B}from"./QChip.fc1367d4.js";import{Q as G}from"./QBtnGroup.8a143a29.js";import{Q as H}from"./QMarkupTable.c292dae4.js";import{d as L}from"./documentosApi.d4af84c5.js";import{_ as J}from"./DialogEliminar.48da2dec.js";import{_ as O}from"./LoaderSpinner.196fa089.js";import{u as W}from"./useQueryClient.esm.ad4fb503.js";import{u as X}from"./useMutation.esm.3aac1ad5.js";import{u as Y}from"./useQuery.esm.48506497.js";import{_ as Z}from"./BreadcrumbNav.24a9f6cf.js";import{u as ee}from"./useVerPeriodoActivo.75af6eda.js";import"./use-dark.fd3c0586.js";import"./axios.a596eead.js";import"./QCardActions.4c1c4976.js";import"./QDialog.82b87909.js";import"./use-prevent-scroll.175dc396.js";import"./focusout.5c99f0fb.js";import"./focus-manager.05708ea9.js";import"./ClosePopup.159f4ab9.js";import"./utils.esm.429db25b.js";import"./mutation.esm.54ea4acf.js";const te=async r=>{try{k.show({delay:500,message:"Cancelando residencia"}),await L.delete("residentes-cancelar/"+r),k.hide()}catch(l){throw k.hide(),l}},se=()=>{const r=W(),{mutate:l}=X(te,{onSuccess:()=>{w.create({message:"Se cancel\xF3 la residencia",color:"positive",position:"top-right",type:"positive"}),r.invalidateQueries({queryKey:["residentes"],exact:!1})},onError:c=>{w.create({message:c+"",color:"negative",position:"top-right",type:"negative"})}});return{cancelarResidencia:l}};const oe=r=>(U("data-v-7578ff5d"),r=r(),j(),r),ae={key:1},ne={class:"flex justify-end"},re=oe(()=>e("thead",null,[e("tr",null,[e("th",null,"Estudiante"),e("th",null,"Empresa"),e("th",null,"Proyecto"),e("th",null,"Acciones")])],-1)),ie={class:"flex items-center q-gutter-sm"},le={class:"columna-ancho-maximo"},ce={class:"columna-ancho-maximo"},de=S({__name:"TablaResidentes",setup(r){const l=async()=>{const{data:o}=await L.get("/residentes");return o},c=E(),m=$(!1),v=$(""),{isLoading:g,data:p}=Y({queryKey:["residentes"],queryFn:()=>l(),keepPreviousData:!0,staleTime:1e3*60*60}),{cancelarResidencia:C}=se(),b=o=>{m.value=!0,v.value=o},f=o=>{c.push({name:"ver-residente",params:{id:o}})},q=o=>{c.push({name:"editar-residente",params:{id:o}})},I="http://registro-documentos.test/api",P=async()=>{const o=I+"/residentes-export-pdf";window.open(o,"_blank")};return(o,Q)=>(a(),u("div",null,[i(g)?(a(),h(O,{key:0})):x("",!0),i(p)&&i(p).length>0?(a(),u("div",ae,[t(J,{modelValue:m.value,"onUpdate:modelValue":Q[0]||(Q[0]=s=>m.value=s),"recurso-id":v.value,onEliminar:i(C),mensaje:"\xBFEstas seguro de cancelar la residencia?"},null,8,["modelValue","recurso-id","onEliminar"]),e("div",ne,[e("div",null,[t(_,{round:"",icon:"picture_as_pdf",color:"negative",size:"sm",onClick:P})])]),t(H,null,{default:n(()=>[re,e("tbody",null,[(a(!0),u(T,null,A(i(p),s=>(a(),u("tr",{key:s.estudiante_id},[e("td",null,[e("div",ie,[e("div",null,[s.url_foto?(a(),h(V,{key:0},{default:n(()=>[t(M,{src:s.url_foto},null,8,["src"])]),_:2},1024)):(a(),h(V,{key:1,color:"primary","text-color":"white"},{default:n(()=>[y(d(s.iniciales_nombre_apellido),1)]),_:2},1024))]),e("div",null,[e("div",null,d(s.nombre_completo),1),e("div",null,[t(B,{dense:"",style:F({backgroundColor:s.color_carrera}),"text-color":"white"},{default:n(()=>[y(d(s.nombre_carrera),1)]),_:2},1032,["style"]),t(B,{dense:"",color:"teal","text-color":"white",icon:"call"},{default:n(()=>[y(d(s.telefono_estudiante),1)]),_:2},1024)])])])]),e("td",le,d(s.nombre_empresa),1),e("td",ce,d(s.proyecto),1),e("td",null,[t(G,{push:""},{default:n(()=>[t(_,{size:"sm",color:"info",push:"",glossy:"",icon:"visibility",onClick:R=>f(s.estudiante_id)},null,8,["onClick"]),t(_,{size:"sm",color:"secondary",push:"",glossy:"",icon:"edit",onClick:R=>q(s.estudiante_id)},null,8,["onClick"]),t(_,{size:"sm",color:"negative",push:"",glossy:"",icon:"block",onClick:R=>b(s.estudiante_id)},null,8,["onClick"])]),_:2},1024)])]))),128))])]),_:1})])):x("",!0)]))}});var ue=N(de,[["__scopeId","data-v-7578ff5d"]]);const me={class:"flex justify-between items-center"},pe={class:"fontsize-15 text-weight-light"},_e={key:0},fe={key:1},Ue=S({__name:"ListarResidente",setup(r){const l=E(),{resource:c,isLoading:m,error:v}=ee(),g=()=>{l.push({name:"crear-residente"})},p=[{label:"Residentes",icon:"history_edu"}];return(C,b)=>(a(),h(K,{padding:""},{default:n(()=>[t(Z,{pages:p,titlePage:"Lista de residentes"}),t(D,null,{default:n(()=>[t(z,null,{default:n(()=>{var f;return[e("div",me,[e("div",pe,[y(" Residentes del periodo "),i(m)?(a(),u("span",_e)):(f=i(c))!=null&&f.nombre?(a(),u("span",fe,d(i(c).nombre),1)):x("",!0)]),t(_,{label:"Asignar",icon:"add_circle_outline",color:"secondary",size:"md",padding:"xs",onClick:g})])]}),_:1}),t(z,null,{default:n(()=>[t(ue)]),_:1})]),_:1})]),_:1}))}});export{Ue as default};
