import{aU as M,aV as C,v as L,r as h,u as p,q as x,s as A,aa as g,d as e,t,A as y,Q as i,ap as P,as as w,B as u,x as j,F as Y,z as K,ab as Z}from"./index.16fafb50.js";import{Q,a as v}from"./QCard.9550f461.js";import{Q as ee}from"./QPage.bd9db12d.js";import{Q as N}from"./QCardActions.4c1c4976.js";import{Q as T}from"./QDialog.82b87909.js";import{Q as G,a as O,b as f,c as te,d as D}from"./QTooltip.c51851d1.js";import{Q as H}from"./QBtnGroup.8a143a29.js";import{C as k}from"./ClosePopup.159f4ab9.js";import{d as R}from"./documentosApi.d4af84c5.js";import{u as ae}from"./useQuery.esm.48506497.js";import{u as I}from"./useQueryClient.esm.ad4fb503.js";import{u as J}from"./useMutation.esm.3aac1ad5.js";import{u as oe}from"./useRestaurarRecurso.c88508a3.js";import{u as le}from"./useObtenerDepartamentos.5d94312b.js";import{_ as re}from"./BreadcrumbNav.24a9f6cf.js";import{g as se}from"./getUser.66bacbda.js";import"./use-dark.fd3c0586.js";import"./use-prevent-scroll.175dc396.js";import"./focusout.5c99f0fb.js";import"./focus-manager.05708ea9.js";import"./QSeparator.c2a03803.js";import"./QList.747496ef.js";import"./QMarkupTable.c292dae4.js";import"./QSelect.3768a279.js";import"./use-key-composition.749118dd.js";import"./uid.42677368.js";import"./QChip.fc1367d4.js";import"./QItem.98cb2d4c.js";import"./QItemLabel.bb4f8a3f.js";import"./QMenu.ab6378a2.js";import"./selection.fb3d903a.js";import"./use-form.e491c393.js";import"./format.2bc25e5f.js";import"./use-checkbox.abf6af25.js";import"./use-fullscreen.eb530c2b.js";import"./axios.a596eead.js";import"./utils.esm.429db25b.js";import"./mutation.esm.54ea4acf.js";const ne=async()=>{try{const{data:l}=await R.get("/departamentos-trashed");return l}catch(l){throw l}},ie=()=>{const{data:l,isLoading:a,error:s,isSuccess:n}=ae(["departamentos-trashed"],ne,{staleTime:36e5});return{departamentosElimnados:l,isLoading:a,error:s,isSuccess:n}},me=async l=>{try{C.show({delay:500,message:"Eliminando..."}),await R.delete("/departamentos-force-delete",{params:{ids:l}}),C.hide()}catch(a){throw C.hide(),a}},ue=()=>{const l=I(),{mutate:a,isLoading:s,error:n,isSuccess:d}=J(me,{onSuccess:()=>{M.create({message:"Se elimin\xF3",color:"positive",position:"top-right",type:"positive"}),l.invalidateQueries({queryKey:["departamentos_eliminados"],exact:!1})}});return{eliminarDepartamento:a,loadingEliminar:s,error:n,isSuccesEliminar:d}},W=[{field:"nombre",name:"nombre",label:"Nombre departamento",align:"left",sortable:!0},{field:"nombre_titular",name:"nombre_titular",label:"Nombre del titular",align:"left",sortable:!0},{field:"apellidos_titular",name:"apellidos_titular",label:"Apellidos del titular",align:"left",sortable:!0},{field:"accion",name:"accion",label:"Acci\xF3n",align:"right",sortable:!0}],de=()=>oe("/departamentos-restore","departamentos","departamentos-trashed"),ce={key:0},pe={key:1},fe=y("span",{class:"q-ml-sm"},"\xBFEstas seguro que quieres eliminar definitivamente estos departamentos?",-1),_e=y("span",{class:"q-ml-sm"},"\xBFEstas seguro que quieres eliminar definitivamente este departamento?",-1),ge={class:"flex justify-end q-gutter-md q-mb-md"},ve=L({__name:"TablaDepartamentosEliminados",setup(l){const a=h([]),s=h(!1),n=h(!1),d=h(""),{departamentosElimnados:V,isLoading:E,isSuccess:z,error:F}=ie(),{eliminarDepartamento:q}=ue(),{restaurarRecurso:$}=de(),B=()=>{const _=a.value.map(m=>m.id.toString());q(_),a.value=[]},c=()=>{const _=a.value.map(m=>m.id.toString());$(_),a.value=[]},b=()=>a.value.length===0?"":`${a.value.length} registro${a.value.length>1?"s":""} seleccionado`,r=()=>{s.value=!0},S=_=>{d.value=_,n.value=!0},X=_=>{q(_)};return(_,m)=>p(z)?(x(),A("div",pe,[e(T,{modelValue:s.value,"onUpdate:modelValue":m[0]||(m[0]=o=>s.value=o),persistent:""},{default:t(()=>[e(Q,null,{default:t(()=>[e(v,{class:"row items-center"},{default:t(()=>[e(P,{icon:"delete_forever",color:"negative","text-color":"white"}),fe]),_:1}),e(N,{align:"right"},{default:t(()=>[w(e(i,{flat:"",label:"Cancelar",color:"primary"},null,512),[[k]]),w(e(i,{flat:"",label:"Aceptar",color:"negative",onClick:B},null,512),[[k]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(T,{modelValue:n.value,"onUpdate:modelValue":m[2]||(m[2]=o=>n.value=o),persistent:""},{default:t(()=>[e(Q,null,{default:t(()=>[e(v,{class:"row items-center"},{default:t(()=>[e(P,{icon:"delete_forever",color:"negative","text-color":"white"}),_e]),_:1}),e(N,{align:"right"},{default:t(()=>[w(e(i,{flat:"",label:"Cancelar",color:"primary"},null,512),[[k]]),w(e(i,{flat:"",label:"Aceptar",color:"negative",onClick:m[1]||(m[1]=o=>X(d.value))},null,512),[[k]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),y("div",ge,[e(i,{disable:!a.value.length,color:"secondary",icon:"restore",onClick:c},null,8,["disable"]),e(i,{disable:!a.value.length,color:"negative",icon:"delete_forever",onClick:r},null,8,["disable"])]),e(G,{bordered:"",rows:p(V),columns:p(W),"row-key":"id",loading:p(E),"selected-rows-label":b,selection:"multiple",selected:a.value,"onUpdate:selected":m[3]||(m[3]=o=>a.value=o),pagination:{rowsPerPage:15}},{body:t(o=>[e(O,{props:o},{default:t(()=>[e(f,null,{default:t(()=>[e(te,{modelValue:o.selected,"onUpdate:modelValue":U=>o.selected=U},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(f,{key:"nombre",props:o},{default:t(()=>[u(g(o.row.nombre),1)]),_:2},1032,["props"]),e(f,{key:"nombre_titular",props:o},{default:t(()=>[u(g(o.row.nombre_titular),1)]),_:2},1032,["props"]),e(f,{key:"apellidos_titular",props:o},{default:t(()=>[u(g(o.row.apellidos_titular),1)]),_:2},1032,["props"]),e(f,{key:"accion",props:o},{default:t(()=>[e(H,{push:""},{default:t(()=>[e(i,{size:"sm",color:"secondary",push:"",glossy:"",icon:"restore",onClick:U=>p($)(o.row.id)},{default:t(()=>[e(D,null,{default:t(()=>[u(" Restaurar departamento ")]),_:1})]),_:2},1032,["onClick"]),e(i,{size:"sm",color:"negative",push:"",glossy:"",icon:"delete_forever",onClick:U=>S(o.row.id)},{default:t(()=>[e(D,null,{default:t(()=>[u(" Forzar eliminaci\xF3n ")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading","selected"])])):(x(),A("div",ce,g(p(F)),1))}}),ye=async l=>{try{C.show({delay:500,message:"Eliminando..."}),await R.delete(`/departamentos/${l}`),C.hide()}catch(a){throw a}},be=()=>{const l=I(),{mutate:a,isLoading:s,error:n,isSuccess:d}=J(ye,{onSuccess:()=>{M.create({message:"Se elimin\xF3",color:"positive",position:"top-right",type:"positive"}),l.invalidateQueries({queryKey:["departamentos"],exact:!1}),l.invalidateQueries({queryKey:["departamentos-trashed"],exact:!1})}});return{eliminarDepartamento:a,loadingEliminar:s,error:n,isSuccess:d}},he=y("span",{class:"q-ml-sm"},"\xBFEstas seguro que quieres eliminar este departamento?",-1),we=L({__name:"TablaDepartamentos",setup(l){const a=j(),s=h(!1),n=h(""),d=le(),{data:V,isLoading:E}=d,z=c=>{a.push({name:"ver-departamento",params:{id:c}})},F=c=>{a.push({name:"editar-departamento",params:{id:c}})},{eliminarDepartamento:q}=be(),$=c=>{n.value=c,s.value=!0},B=c=>{q(c)};return(c,b)=>(x(),A(Y,null,[e(T,{modelValue:s.value,"onUpdate:modelValue":b[1]||(b[1]=r=>s.value=r),persistent:""},{default:t(()=>[e(Q,null,{default:t(()=>[e(v,{class:"row items-center"},{default:t(()=>[e(P,{icon:"delete",color:"negative","text-color":"white"}),he]),_:1}),e(N,{align:"right"},{default:t(()=>[w(e(i,{flat:"",label:"Cancelar",color:"primary"},null,512),[[k]]),w(e(i,{flat:"",label:"Aceptar",color:"primary",onClick:b[0]||(b[0]=r=>B(n.value))},null,512),[[k]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(G,{flat:"",bordered:"",rows:p(V),columns:p(W),"row-key":"name",loading:p(E)},{body:t(r=>[e(O,{props:r},{default:t(()=>[e(f,{key:"nombre",props:r},{default:t(()=>[u(g(r.row.nombre),1)]),_:2},1032,["props"]),e(f,{key:"nombre_titular",props:r},{default:t(()=>[u(g(r.row.nombre_titular),1)]),_:2},1032,["props"]),e(f,{key:"apellidos_titular",props:r},{default:t(()=>[u(g(r.row.apellidos_titular),1)]),_:2},1032,["props"]),e(f,{key:"accion",props:r},{default:t(()=>[e(H,{push:""},{default:t(()=>[e(i,{size:"sm",color:"info",push:"",glossy:"",icon:"visibility",onClick:S=>z(r.row.id)},{default:t(()=>[e(D,null,{default:t(()=>[u(" Ver departamento ")]),_:1})]),_:2},1032,["onClick"]),e(i,{size:"sm",color:"secondary",push:"",glossy:"",icon:"edit",onClick:S=>F(r.row.id)},{default:t(()=>[e(D,null,{default:t(()=>[u(" Editar departamento ")]),_:1})]),_:2},1032,["onClick"]),e(i,{size:"sm",color:"negative",push:"",glossy:"",icon:"delete",onClick:S=>$(r.row.id)},{default:t(()=>[e(D,null,{default:t(()=>[u(" Eliminar departamento ")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading"])],64))}}),ke={class:"flex justify-between items-center"},Ce=y("div",{class:"fontsize-15 text-weight-light"},"Departamentos",-1),De=y("div",{class:"fontsize-15 text-weight-light"}," Departamentos eliminados ",-1),mt=L({__name:"ListarDepartamento",setup(l){const a=[{label:"Departamentos",icon:"account_balance"}],s=j(),n=()=>{s.push({name:"crear-departamento"})},d=se();return(V,E)=>(x(),K(ee,{padding:""},{default:t(()=>[e(re,{pages:a,titlePage:"Lista de departamentos"}),e(Q,null,{default:t(()=>[e(v,null,{default:t(()=>[y("div",ke,[Ce,e(i,{label:"Nuevo",icon:"add_circle_outline",color:"secondary",size:"md",padding:"xs",onClick:n})])]),_:1}),e(v,null,{default:t(()=>[e(we)]),_:1})]),_:1}),p(d)==="admin"?(x(),K(Q,{key:0,class:"q-mt-md"},{default:t(()=>[e(v,null,{default:t(()=>[De]),_:1}),e(v,null,{default:t(()=>[e(ve)]),_:1})]),_:1})):Z("",!0)]),_:1}))}});export{mt as default};
