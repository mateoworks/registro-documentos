import{a as x,Q as R}from"./QCard.9550f461.js";import{Q as B}from"./QBanner.f76ac382.js";import{Q as A}from"./QInput.ec90feeb.js";import{Q as V}from"./QSelect.3768a279.js";import{r as N,x as F,v as M,aq as P,c as D,q as m,z as y,t as a,d as r,u as o,s as h,A as t,aa as _,ac as U,B as f,F as K,ar as O,ab as S,Q as T}from"./index.16fafb50.js";import{Q as $}from"./QForm.5f43623c.js";import{Q as I}from"./QPage.bd9db12d.js";import{g as j}from"./errorUtils.9be85d5d.js";import{u as G}from"./useVerResidente.a1fe8f69.js";import{_ as H}from"./BreadcrumbNav.24a9f6cf.js";import{_ as J}from"./LoaderSpinner.196fa089.js";import{u as W}from"./useObtenerPeriodos.fd2c7100.js";import{u as X}from"./useObtenerEmpresas.ce7d49b0.js";import{d as Y}from"./documentosApi.d4af84c5.js";import{u as Z}from"./useQueryClient.esm.ad4fb503.js";import{u as ee}from"./useMutation.esm.3aac1ad5.js";import"./use-dark.fd3c0586.js";import"./use-key-composition.749118dd.js";import"./uid.42677368.js";import"./focus-manager.05708ea9.js";import"./use-form.e491c393.js";import"./QChip.fc1367d4.js";import"./QItem.98cb2d4c.js";import"./QItemLabel.bb4f8a3f.js";import"./QMenu.ab6378a2.js";import"./selection.fb3d903a.js";import"./focusout.5c99f0fb.js";import"./QDialog.82b87909.js";import"./use-prevent-scroll.175dc396.js";import"./format.2bc25e5f.js";import"./useQuery.esm.48506497.js";import"./utils.esm.429db25b.js";import"./useRecursosMultiples.fa0015da.js";import"./axios.a596eead.js";import"./mutation.esm.54ea4acf.js";const oe=async p=>{const{data:i}=await Y.post("residentes-actualizar",p,{headers:{"Content-Type":"multipart/form-data"}});return i},se=p=>{const i=N(null),n=Z(),g=F(),{mutate:s,isLoading:v}=ee(oe,{onSuccess:()=>{n.invalidateQueries({queryKey:["residentes"],exact:!1}),n.invalidateQueries({queryKey:["residente",p],exact:!1}),g.push({name:"listar-residente"})},onError:u=>{var c;u.response?i.value=(c=u.response)==null?void 0:c.data:i.value=u}});return{mutate:s,errorServer:i,isLoading:v}},te={key:1,class:"row"},ae={class:"col-12"},re={class:"fontsize-15 text-weight-light"},ie={class:"row"},ne={class:"col-xs-12 col-sm-8"},le={class:"row q-col-gutter-md"},de={class:"col-12"},me={class:"col-xs-12 col-sm-10"},ue=t("span",{class:"required-star"},"*",-1),pe={class:"col-xs-12 col-sm-10"},ce=t("span",{class:"required-star"},"*",-1),_e={class:"col-xs-12 col-sm-10"},fe=t("span",{class:"required-star"},"*",-1),ge={class:"col-xs-12 col-sm-7"},Ye=M({__name:"EditarResidente",setup(p){const i=P(),{id:n=""}=i.params,{isLoading:g,residente:s}=G(n+""),{data:v,isLoading:u}=W(),{data:c,isLoading:q}=X(),{mutate:E,errorServer:b,isLoading:L}=se(n+""),w=()=>{const l=new FormData;l.append("estudiante_id",n+""),l.append("empresa_id",s.value.id_empresa),l.append("proyecto",s.value.proyecto),l.append("periodo_id",s.value.id_periodo),E(l)},k=b.value,z=D(()=>j(b.value)),C=[{label:"Residentes",icon:"history_edu",to:"listar-residente"},{label:"Editar residente",icon:"edit"}];return(l,d)=>(m(),y(I,{padding:""},{default:a(()=>[r(H,{pages:C,titlePage:"Editar residente"}),o(g)?(m(),y(J,{key:0})):o(s)?(m(),h("div",te,[t("div",ae,[r(R,null,{default:a(()=>[r(x,null,{default:a(()=>[t("div",re," Actualizar residencia de "+_(o(s).nombre_estudiante)+" "+_(o(s).apellidos),1)]),_:1}),r($,{onSubmit:U(w,["prevent"])},{default:a(()=>[r(x,null,{default:a(()=>[t("div",ie,[t("div",ne,[t("div",le,[t("div",de,[o(b)?(m(),y(B,{key:0,"inline-actions":"",class:"text-white bg-red"},{default:a(()=>{var e;return[f(_(((e=o(k))==null?void 0:e.message)||"")+" ",1),t("ul",null,[(m(!0),h(K,null,O(z.value,Q=>(m(),h("li",{key:Q},_(Q),1))),128))])]}),_:1})):S("",!0)]),t("div",me,[r(A,{modelValue:o(s).proyecto,"onUpdate:modelValue":d[0]||(d[0]=e=>o(s).proyecto=e),"label-slot":"",rules:[e=>!!e||"El proyecto es requerido",e=>e.length>3&&e.length<255||"Debe tener m\xE1s de 3 caracteres y menos de 255"]},{label:a(()=>[f(" Nombre del proyecto: "),ue]),_:1},8,["modelValue","rules"])]),t("div",pe,[r(V,{modelValue:o(s).id_periodo,"onUpdate:modelValue":d[1]||(d[1]=e=>o(s).id_periodo=e),options:o(v),"label-slot":"","option-value":"id","option-label":"nombre",loading:o(u),"emit-value":"","map-options":"",rules:[e=>!!e||"Selecciona un periodo"]},{label:a(()=>[f(" Selecciona un periodo "),ce]),_:1},8,["modelValue","options","loading","rules"])]),t("div",_e,[r(V,{modelValue:o(s).id_empresa,"onUpdate:modelValue":d[2]||(d[2]=e=>o(s).id_empresa=e),options:o(c),"label-slot":"","option-value":"id","option-label":"nombre",loading:o(q),"emit-value":"","map-options":"",rules:[e=>!!e||"Selecciona una empresa"]},{label:a(()=>[f(" Selecciona una empresa "),fe]),_:1},8,["modelValue","options","loading","rules"])]),t("div",ge,[r(T,{label:"Actualizar residencia",color:"primary",type:"submit",loading:o(L)},null,8,["loading"])])])])])]),_:1})]),_:1},8,["onSubmit"])]),_:1})])])):S("",!0)]),_:1}))}});export{Ye as default};
